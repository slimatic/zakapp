# Staging Environment Configuration Template
# Copy this file to .env.staging and fill in the actual values
# NEVER commit .env.staging to version control!

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
NODE_ENV=staging
PORT=3002

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL (Staging)
DATABASE_URL=postgresql://zakapp_user:YOUR_DB_PASSWORD@database:5432/zakapp_staging
DB_PASSWORD=YOUR_SECURE_DB_PASSWORD_HERE

# SQLite (Alternative - for lightweight staging)
# DATABASE_URL=file:./data/zakapp-staging.db

# =============================================================================
# SECURITY SETTINGS (CRITICAL - MUST BE CHANGED!)
# =============================================================================
# JWT Secrets (minimum 32 characters, use: openssl rand -base64 32)
JWT_SECRET=REPLACE_WITH_RANDOM_32_CHAR_SECRET_FOR_ACCESS_TOKENS
JWT_REFRESH_SECRET=REPLACE_WITH_DIFFERENT_32_CHAR_SECRET_FOR_REFRESH_TOKENS

# Encryption Key (EXACTLY 32 characters, use: openssl rand -hex 16)
ENCRYPTION_KEY=REPLACE_WITH_EXACTLY_32_CHAR_KEY

# Token Expiration
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# =============================================================================
# FRONTEND CONFIGURATION
# =============================================================================
REACT_APP_API_BASE_URL=http://localhost:3002/api
REACT_APP_SERVER_URL=http://localhost:3002

# For deployed staging with domain:
# REACT_APP_API_BASE_URL=https://staging-api.zakapp.example.com/api
# REACT_APP_SERVER_URL=https://staging-api.zakapp.example.com

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Local staging
CORS_ORIGIN=http://localhost:3000,http://127.0.0.1:3000

# Deployed staging (add your staging domain)
# CORS_ORIGIN=https://staging.zakapp.example.com,https://staging-api.zakapp.example.com

# =============================================================================
# LOGGING & MONITORING
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json

# Enable detailed logging for debugging (set to 'true' for staging)
DEBUG_MODE=true

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# NISAB THRESHOLDS (Islamic Finance)
# =============================================================================
# Gold price source API (optional, for automatic updates)
# GOLD_PRICE_API_KEY=your_api_key_here

# Manual nisab thresholds (fallback)
NISAB_GOLD_GRAMS=85
NISAB_SILVER_GRAMS=595

# =============================================================================
# EMAIL CONFIGURATION (Optional - for password reset)
# =============================================================================
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=noreply@zakapp.example.com
# SMTP_PASSWORD=your_smtp_password
# SMTP_FROM=ZakApp <noreply@zakapp.example.com>

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_DIR=/app/data/backups

# =============================================================================
# FEATURE FLAGS (Staging Testing)
# =============================================================================
ENABLE_REGISTRATION=true
ENABLE_PASSWORD_RESET=true
ENABLE_MULTI_METHODOLOGY=true
ENABLE_EXPORT_FEATURES=true

# =============================================================================
# PERFORMANCE & SCALING
# =============================================================================
# Database connection pool
DB_POOL_MIN=2
DB_POOL_MAX=10

# Request timeout (milliseconds)
REQUEST_TIMEOUT=30000

# =============================================================================
# TESTING & QA
# =============================================================================
# Test database (for integration tests)
TEST_DATABASE_URL=file:./data/test.db

# Playwright E2E tests
PLAYWRIGHT_BASE_URL=http://localhost:3000
PLAYWRIGHT_API_URL=http://localhost:3002

# =============================================================================
# SECURITY HEADERS
# =============================================================================
HELMET_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# =============================================================================
# DATA MIGRATION
# =============================================================================
# Path to JSON data files (if migrating from old system)
MIGRATION_SOURCE_DIR=/app/data/migration-source
MIGRATION_BACKUP_DIR=/app/data/migration-backups

# =============================================================================
# DEPLOYMENT INFO (for monitoring/debugging)
# =============================================================================
DEPLOYMENT_ENV=staging
DEPLOYMENT_VERSION=1.0.0
DEPLOYMENT_DATE=2025-10-03
GIT_COMMIT_HASH=3f21fcd

# =============================================================================
# NOTES FOR DEPLOYMENT
# =============================================================================
# 1. Generate secure secrets:
#    - JWT_SECRET: openssl rand -base64 32
#    - JWT_REFRESH_SECRET: openssl rand -base64 32  
#    - ENCRYPTION_KEY: openssl rand -hex 16
#
# 2. Update CORS_ORIGIN with your staging domain
#
# 3. Use strong database password (16+ characters, mixed case, numbers, symbols)
#
# 4. Enable HTTPS in production (use Let's Encrypt)
#
# 5. Set up regular database backups
#
# 6. Monitor logs for security events
#
# 7. Test all Islamic calculation methodologies after deployment
